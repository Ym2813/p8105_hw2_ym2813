p8105\_hw2\_ym2813
================
Anna Ma
10/4/2021

``` r
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──

    ## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
    ## ✓ tibble  3.1.4     ✓ dplyr   1.0.7
    ## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
    ## ✓ readr   2.0.1     ✓ forcats 0.5.1

    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
library(readxl)
```

## Problem 1

Read and clean the Mr.Trash Wheel sheet

``` r
trash_wheel_df = 
  read_excel("data_hw2/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", 
             sheet = 1, col_names = TRUE, range = "A2:N534") %>% 
  janitor::clean_names() %>%  #clean the variable names
  drop_na(dumpster) %>% #omitting rows without dumpster-specific data
  rename(weight = weight_tons,volume = volume_cubic_yards) %>% #reasonable variable name 
  mutate(sports_balls = round(sports_balls,0)) #round sports_ball to integer
```

Read and clean precipitation data for 2018

``` r
precipitation_2018_df = 
  read_excel("data_hw2/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", 
             sheet = 7, range = "A2:B15") %>% 
  janitor::clean_names() %>% 
  drop_na() %>% 
  mutate(year = "2018") %>% 
  select(year,month,total)
```

Read and clean precipitation data for 2019

``` r
precipitation_2019_df = 
  read_excel("data_hw2/Trash-Wheel-Collection-Totals-7-2020-2.xlsx", 
             sheet = 6, range = "A2:B15") %>% 
  janitor::clean_names() %>% 
  drop_na() %>% 
  mutate(year = "2019") %>% 
  select(year,month,total)
```

Combine precipitation datasets and convert month to a character variable

``` r
precipitation_both_df = 
  bind_rows(precipitation_2018_df, precipitation_2019_df) %>% 
  mutate(month = month.name[month])
```

In the Mr. Trash Wheel data set, we have a total of 453 observations,
each representing a dumpster. The data set collects key information
about Mr. Trash Wheel such as specific dumpster number, date, amount of
trash they collected in weight and volume, types of trash they collected
such as bottles, polystyrene, cigarette butts, and bags, and the homes
they powered. The median number of sports balls in a dumpster in 2019 is
9.

In the data set for precipitation in 2018, we have a total of
12observations, which lists out the month with precipitation and the
total amount of precipitation within that month. Similarly, we have a
total of 12 observations in the 2019 precipitation data set, listing the
month and the total amount of precipitation. In the combined data set,
we have 24 observations, which lists out all the month with
precipitations in both 2018 and 2019; and also the total amount of
precipitation in each month and year. The total precipitation in 2018 is
70.33

## Problem 2

Read and clean the data in pols\_month

``` r
pols_month_df = 
  read_csv("data_hw2/fivethirtyeight_datasets/pols-month.csv") %>% 
  separate("mon",c("year","month","day"),sep = "-") %>% 
  mutate(
    month = month.name[as.numeric(month)],
    president = case_when(prez_gop >= 1 ~ "gop",
                          prez_dem == 1 ~ "dem")
    ) %>% 
  select(-c(day,prez_dem,prez_gop))
```

    ## Rows: 822 Columns: 9

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

read and clean the data in snp.csv

``` r
snp_df = 
  read_csv("data_hw2/fivethirtyeight_datasets/snp.csv") %>%
  separate(date,c("month","day","year"),sep = "/") %>% 
  mutate(year = as.numeric(year),
         month = as.numeric(month),
         year = case_when(year <= 15 ~ 2000+ year ,
                          year > 15 ~ 1900+year)) %>% 
  arrange(year,month) %>% 
  mutate(
     month = month.name[month],
     year = as.character(year)) %>% 
  select(year,month,everything()) 
```

    ## Rows: 787 Columns: 2

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Tidy the unemployment data set

``` r
unemployment_df = 
  read_csv("data_hw2/fivethirtyeight_datasets/unemployment.csv",
           col_names = c("year", "1":"12"),skip = 1) %>%
  pivot_longer(
    "1":"12",
    names_to = "month",
    values_to = "percentage") %>% 
  mutate(
     month = month.name[as.numeric(month)],
     year = as.character(year))
```

    ## Rows: 68 Columns: 13

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): year, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Join the data sets

``` r
combined_df = 
  left_join(pols_month_df, snp_df, by = c("year","month")) %>% 
  left_join(unemployment_df, by = c("year","month"))
```

The pols-month data set has 822 observations and 9 variables. It
contained the number of national politicians who are democratic or
republican in the 68 years ranging from January 1947 and June 2015. Some
of the key variables includes the party of the president on the
associated date, the number of republican or democratic governors,
senators,or representatives on the associated date.  
The snp data set has 787 observations and 4 variables. It contained the
Standard & Poor’s stock market index in 65 years ranging between January
3rd 1950 to July 1st 2015. The key variables are date of observation,
including year, month, and day, and the closing values of the S&P stock
index on the observation date.

The unemployment data set has 816 observations and 3 variables. It
contained the information about the percentage of unemployment of each
month between 1948 to 2015, a range of 67 years. The key variables are
year, month, and the percentage of unemployment.

The resulting data set is composed of the pols-month, snp, and
unemployment data set. It has 822 observations and 12 variables. This is
because we merged snp and unemployment into the pols-month data set,
which will keep everything in the pols-month and merge the snp and
unemployment data by year and month.The final data set contained the
number of national politicians who are democratic or republican, the
Standard & Poor’s stock market index, and the unemployment percentage of
each month in 68 years, ranging from January 1947 and June 2015.

## Problem 3

Read and tidy the data

``` r
baby_names_df = 
  read_csv("data_hw2/Popular_Baby_Names.csv") %>% 
  janitor::clean_names() %>% 
  rename("year" = year_of_birth, "name" = childs_first_name) %>%
  mutate(gender = str_to_lower(gender),
         name = str_to_lower(name),
         ethnicity = case_when(
         str_detect(ethnicity,"ASIAN") ~ "asian and pacific islander",
         str_detect(ethnicity,"BLACK") ~ "black non hispanic",
         ethnicity == "HISPANIC"  ~ "hispanic",
         str_detect(ethnicity,"WHITE") ~ "white non hispanic")) %>%
  distinct() # remove duplicate rows
```

    ## Rows: 19418 Columns: 6

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (3): Gender, Ethnicity, Child's First Name
    ## dbl (3): Year of Birth, Count, Rank

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

The data set has 12181 observations and 6 variables, including birth
year, gender, ethnicity, name, count, and rank.
